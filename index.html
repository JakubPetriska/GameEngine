<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>GameEngine by JakubPetriska</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">GameEngine</h1>
      <h2 class="project-tagline">Simple game engine for Android written in Java</h2>
      <a href="https://github.com/JakubPetriska/GameEngine" class="btn">View on GitHub</a>
      <a href="https://github.com/JakubPetriska/GameEngine/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/JakubPetriska/GameEngine/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>Simple game engine for Android written in Java.
Engine currently supports Android 2.3 (API level 9) and up.</p>

<p><img src="https://jakubpetriska.github.io/GameEngine/images/showcase.png" alt=""></p>

<p><img src="https://jakubpetriska.github.io/GameEngine/images/sample.png" alt=""></p>

<p>Created as a bachelor's thesis at CTU in Prague.</p>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Documentation</h2>

<p>Complete javadoc for engine's API can be seen <a href="https://jakubpetriska.github.io/GameEngine/javadoc-0.4.1/index.html">here</a>.</p>

<h2>
<a id="coordinate-system" class="anchor" href="#coordinate-system" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Coordinate system</h2>

<p>Left-handed coordinate system with <em>z</em> axis pointing forward, <em>y</em> pointing up and <em>x</em> to the right.</p>

<h2>
<a id="tutorial" class="anchor" href="#tutorial" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tutorial</h2>

<p>In this tutorial you will create a simple application showing only the engine content. Engine will display an object that player will be able to move using his finger.</p>

<p>For more examples and samples of working projects using the engine check out the <em>sample</em> and <em>showcase</em> project modules. These contain the sample and showcase applications respectively.</p>

<h3>
<a id="project-setup" class="anchor" href="#project-setup" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project setup</h3>

<p>Create new Android Studio project and either add the whole <em>engine</em> and <em>android-adapter</em> modules into your project, upon which module with your application will be dependent or build the engine's aar file and add it to your project.</p>

<p>Now you must add the engine activity to the AndroidManifest.xml. In this tutorial you will add the activity as main application activity, however it does not have to be the main activity.</p>

<p>To add this activity, place the following code into  tag of your AndroidManifest.xml.</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">activity</span> <span class="pl-e">android</span><span class="pl-e">:</span><span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>com.monolith.api.android.MonolithActivity<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">intent-filter</span>&gt;
        &lt;<span class="pl-ent">action</span> <span class="pl-e">android</span><span class="pl-e">:</span><span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>android.intent.action.MAIN<span class="pl-pds">"</span></span> /&gt;
        &lt;<span class="pl-ent">category</span> <span class="pl-e">android</span><span class="pl-e">:</span><span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>android.intent.category.LAUNCHER<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">intent-filter</span>&gt;
&lt;/<span class="pl-ent">activity</span>&gt;</pre></div>

<h3>
<a id="add-scene" class="anchor" href="#add-scene" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Add scene</h3>

<p>To be able to run the application a few configuration files are needed. All engine configuration files are located in the application's assets folder, specifically in <em>assets/gameengine</em>.</p>

<p>First configuration file that needs to be created is <em>scenes.xml</em> file that needs to be located on <em>assets/gameenigine/scenes.xml</em>. This file defines what scenes engine can display and which scene is default. In our application default scene will always be displayed as first.</p>

<p>Create this file with following content:</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">scenes</span>
    <span class="pl-e">defaultSceneName</span>=<span class="pl-s"><span class="pl-pds">"</span>main_scene<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">scene</span>
        <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>main_scene<span class="pl-pds">"</span></span>
        <span class="pl-e">sceneFilePath</span>=<span class="pl-s"><span class="pl-pds">"</span>scenes/main_scene.xml<span class="pl-pds">"</span></span>/&gt;
&lt;/<span class="pl-ent">scenes</span>&gt;</pre></div>

<p>Content of this file says that our engine has a single scene named <em>main_scene</em> and it is a default scene. Now there is one more thing. Every scene needs to have it's definition file. This file defines what is in the scene when it is loaded. It can be placed anywhere in the <em>assets/gameengine</em> folder and it's path needs to be specified in the <em>scenes.xml</em> file for every scene using the <em>sceneFilePath</em> attribute of <em></em> tag. Create the <em>assets/gameengine/scenes/main_scene.xml</em> now.</p>

<p>Game engine's scene consists of objects with components. Objects hold things such as transformation while components add functionality such as rendering a 3D object. Scripts are also components.</p>

<p>In our scene there will be a cube that user will be able to move with his finger. We will create an object on the initial position of our cube that will contain two components. First component will be Mesh component, responsible for rendering the cube and second component will be the script controlling it's movement. Let's start with the cube.</p>

<p>Copy the following code into your <em>main_scene.xml</em>:</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">scene</span>&gt;
    &lt;<span class="pl-ent">gameObjects</span>&gt;
        &lt;<span class="pl-ent">gameObject</span>&gt;
            &lt;<span class="pl-ent">transform</span>&gt;
                &lt;<span class="pl-ent">position</span> <span class="pl-e">x</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-e">y</span>=<span class="pl-s"><span class="pl-pds">"</span>0<span class="pl-pds">"</span></span> <span class="pl-e">z</span>=<span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span> /&gt;
            &lt;/<span class="pl-ent">transform</span>&gt;
            &lt;<span class="pl-ent">components</span>&gt;
                &lt;<span class="pl-ent">component</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>mesh<span class="pl-pds">"</span></span>&gt;
                    &lt;<span class="pl-ent">params</span>&gt;
                        &lt;<span class="pl-ent">param</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>meshPath<span class="pl-pds">"</span></span>&gt;cube&lt;/<span class="pl-ent">param</span>&gt;
                    &lt;/<span class="pl-ent">params</span>&gt;
                &lt;/<span class="pl-ent">component</span>&gt;
            &lt;/<span class="pl-ent">components</span>&gt;
        &lt;/<span class="pl-ent">gameObject</span>&gt;
    &lt;/<span class="pl-ent">gameObjects</span>&gt;
&lt;/<span class="pl-ent">scene</span>&gt;</pre></div>

<p>You can see that <em></em> tag contains <em></em> tag which contains all top level objects of this scene. In our scene there is only one object specified by <em></em> tag in our game objects collection. Our game object contains two other tags. These are <em></em>, containing initial position of the object and <em></em> which contains all object's components. We specify component's type and in the parameters we specify primitive that we want to render.</p>

<p>Project can now be built so please go ahead and test it.</p>

<h3>
<a id="control-the-cube" class="anchor" href="#control-the-cube" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Control the cube</h3>

<p>Application will use the touch input to move the cube. First we need to add new component that will control the cube and attach it to the cube's object. Create new java class and extend the <em>Component</em> class from engine's API. Now head to your <em>main_scene.xml</em> and add new component into the <em></em> tag. Add a <em>type</em> attribute to the new component and put in the full class name, with package, of your new component. In our example project this line looks like this:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">component</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>com.jakubpetriska.gameengine.samples.basic.CubeController<span class="pl-pds">"</span></span>/&gt;</pre></div>

<p>In order to access touch input in our component we need to use the <em>Application</em> class from engine's API. This class acts as a container for objects that provide all the important functionality. Reference to the instance of <em>Application</em> is stored in every <em>Component</em> and it can be obtained with calling the <em>getApplication()</em> method of <em>Component</em>. This is the <em>Component</em> that we'll use for controlling our cube:</p>

<div class="highlight highlight-source-java"><pre><span class="pl-k">import</span> <span class="pl-smi">com.monolith.api.Component</span>;
<span class="pl-k">import</span> <span class="pl-smi">com.monolith.api.Time</span>;
<span class="pl-k">import</span> <span class="pl-smi">com.monolith.api.Touch</span>;
<span class="pl-k">import</span> <span class="pl-smi">java.util.List</span>;

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">CubeController</span> <span class="pl-k">extends</span> <span class="pl-e">Component</span> {

    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">final</span> <span class="pl-k">float</span> <span class="pl-c1">MOVEMENT_CONSTANT</span> <span class="pl-k">=</span> <span class="pl-c1">0.2f</span>;

    <span class="pl-c">// Save the last touch position to calculate position deltas</span>
    <span class="pl-k">private</span> <span class="pl-k">float</span> mLastTouchX <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;
    <span class="pl-k">private</span> <span class="pl-k">float</span> mLastTouchY <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">update</span>() {
        <span class="pl-smi">Time</span> time <span class="pl-k">=</span> getApplication()<span class="pl-k">.</span>getTime();
        <span class="pl-k">List&lt;<span class="pl-smi">Touch</span>&gt;</span> touches <span class="pl-k">=</span> getApplication()<span class="pl-k">.</span>getTouchInput()<span class="pl-k">.</span>getTouches();
        <span class="pl-k">if</span> (touches<span class="pl-k">.</span>size() <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>) {
            <span class="pl-c">// For simplicity we will always use the first running gesture</span>
            <span class="pl-smi">Touch</span> touch <span class="pl-k">=</span> touches<span class="pl-k">.</span>get(<span class="pl-c1">0</span>);

            <span class="pl-c">// Deltas need to be negated to move into the direction of touch</span>
            <span class="pl-k">float</span> touchXDelta <span class="pl-k">=</span> <span class="pl-k">-</span>(touch<span class="pl-k">.</span>getX() <span class="pl-k">-</span> mLastTouchX);
            <span class="pl-k">float</span> touchYDelta <span class="pl-k">=</span> <span class="pl-k">-</span>(touch<span class="pl-k">.</span>getY() <span class="pl-k">-</span> mLastTouchY);

            <span class="pl-k">if</span> (mLastTouchX <span class="pl-k">!=</span> <span class="pl-k">-</span><span class="pl-c1">1</span> <span class="pl-k">&amp;&amp;</span> mLastTouchY <span class="pl-k">!=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>) {
                getGameObject()<span class="pl-k">.</span>transform<span class="pl-k">.</span>moveBy(
                        touchXDelta <span class="pl-k">*</span> time<span class="pl-k">.</span>getTimeDelta() <span class="pl-k">*</span> <span class="pl-c1">MOVEMENT_CONSTANT</span>,
                        touchYDelta <span class="pl-k">*</span> time<span class="pl-k">.</span>getTimeDelta() <span class="pl-k">*</span> <span class="pl-c1">MOVEMENT_CONSTANT</span>,
                        <span class="pl-c1">0</span>);
            }

            <span class="pl-k">if</span> (touch<span class="pl-k">.</span>getState() <span class="pl-k">==</span> <span class="pl-smi">Touch</span><span class="pl-c1"><span class="pl-k">.</span>STATE_ENDED</span>) {
                <span class="pl-c">// Reset our positions when touch ends</span>
                mLastTouchX <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;
                mLastTouchY <span class="pl-k">=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;
            } <span class="pl-k">else</span> {
                <span class="pl-c">// Save our new positions</span>
                mLastTouchX <span class="pl-k">=</span> touch<span class="pl-k">.</span>getX();
                mLastTouchY <span class="pl-k">=</span> touch<span class="pl-k">.</span>getY();
            }
        }
    }
}</pre></div>

<p>Every <em>Component</em> has a set of life cycle methods that can be overridden to provide component's functionality. In our <em>CubeController</em> we override the <em>update()</em> method. This method is called during every frame of the application's life. Please refer to engine's API documentation for complete list of all methods in <em>Component</em> class.</p>

<p>To respond to touch events and move the cube we use two objects from <em>Application</em>. These are the <em>Time</em> object, providing time information and the <em>TouchInput</em> object, which provides information about currently running touch events.</p>

<h3>
<a id="adding-another-cube" class="anchor" href="#adding-another-cube" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adding another cube</h3>

<p>To make our game little more interesting we will put a second cube into the game to move along the first one. To do this easily we'll just add the second cube as a child object of the first cube.</p>

<p>In our <em>main_scene.xml</em> add new <em></em> tag into our <em></em> tag of our first cube. Now add the following object into the <em></em> tag:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">gameObject</span>&gt;
    &lt;<span class="pl-ent">transform</span>&gt;
        &lt;<span class="pl-ent">position</span> <span class="pl-e">x</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-e">y</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-e">z</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> /&gt;
    &lt;/<span class="pl-ent">transform</span>&gt;
    &lt;<span class="pl-ent">components</span>&gt;
        &lt;<span class="pl-ent">component</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>mesh<span class="pl-pds">"</span></span>&gt;
            &lt;<span class="pl-ent">params</span>&gt;
                &lt;<span class="pl-ent">param</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>meshPath<span class="pl-pds">"</span></span>&gt;cube&lt;/<span class="pl-ent">param</span>&gt;
            &lt;/<span class="pl-ent">params</span>&gt;
        &lt;/<span class="pl-ent">component</span>&gt;
    &lt;/<span class="pl-ent">components</span>&gt;
&lt;/<span class="pl-ent">gameObject</span>&gt;</pre></div>

<p>We do not need to add another instance of the <em>CubeController</em> component to this object because it is automatically moved by it's parent. It's transformation is only relative to it's parent's transformation.</p>

<p>Build and run the project. Your first application is now complete, congratulations!</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<pre><code>Copyright 2016 Jakub Petriska

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/JakubPetriska/GameEngine">GameEngine</a> is maintained by <a href="https://github.com/JakubPetriska">JakubPetriska</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
